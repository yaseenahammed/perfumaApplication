
        


<%- include("../../views/partials/admin/header") %>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<style>
  
       .pagination-container {
  display: flex;
  justify-content: center;
  align-items: center;
  margin: 30px 0;
  flex-wrap: wrap;
  gap: 8px;
}

.pagination-container a,
.pagination-container span {
  display: inline-block;
  padding: 8px 14px;
  font-size: 14px;
  text-decoration: none;
  color: #007bff;
  border: 1px solid #ddd;
  border-radius: 6px;
  background-color: #fff;
  transition: all 0.2s ease-in-out;
}

.pagination-container a:hover {
  background-color: #007bff;
  color: #fff;
  border-color: #007bff;
}

.pagination-container .current-page {
  background-color: #007bff;
  color: #fff;
  border-color: #007bff;
  font-weight: bold;
  cursor: default;
}
   
</style>
<section class="content-main">
  <div class="content-header">
    <div>
      <h2 class="content-title card-title">Brands</h2>
    </div>
  </div>
  <div class="card">
    <div class="card-body">
      <div class="row">
        <div class="col-md-3">
       
           <form id="addBrandForm" enctype="multipart/form-data">
  <div class="mb-4">
    <label for="product_name" class="form-label">Brand Name</label>
    <input type="text" name="name" placeholder="Type here" class="form-control" />
  </div>
  <label for="product_name" class="form-label">Brand Image</label>
  <div class="input-upload">
    <img src="" alt=""/>
    <input class="form-control border" name="image" type="file" />
  </div>
  <div class="d-grid">
    <button class="btn btn-primary mt-20" type="submit">
      Add Brand
    </button>
  </div>
</form>

        </div>
        <div class="col-md-7 ml-105">
          <div class="table-responsive">
            <table class="table table-hover">
              <thead>
                <tr>
                  <th>Brand</th>
                  <th>Logo</th>
                  <th>Status</th>
                  <th>Block/Unblock/Delete</th>
                </tr>
              </thead>
              <% data.reverse().forEach((brand) => { %>
  <tr>
    <td><%= brand.name %></td>
    <td>
      <img src="/uploads/re-image/<%= brand.brandImage %>" alt="<%= brand.name %>" width="40" />
    </td>
    <td>
      <% if (brand.isBlocked) { %>
        <span class="badge bg-danger">Blocked</span>
      <% } else { %>
        <span class="badge bg-success">Active</span>
      <% } %>
    </td>
    <td>
      <% if (!brand.isBlocked) { %>
        

       <a href="/admin/blockBrand?id=<%= brand._id %>" class="btn btn-danger">Block</a>
      <% } else { %>
       <a href="/admin/unblockBrand?id=<%= brand._id %>" class="btn btn-success">Unblock</a>
      <% } %>
     <a href="/admin/deleteBrand?id=<%= brand._id %>" class="btn btn-danger "  style="padding-left: 15px;"   onclick="return confirm('Delete this brand?')">Delete</a>
    </td>
  </tr>
<% }) %>

</tbody>

            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
   <!-- Pagination -->
    <div class="pagination-container">
      <% if (currentPage > 1) { %>
      <a href="?page=<%= currentPage - 1 %>">&laquo; Previous</a>
      <% } %> <% for (let i = 1; i <= totalPages; i++) { %> <% if (i ===
      currentPage) { %>
      <span class="current-page"><%= i %></span>
      <% } else { %>
      <a href="?page=<%= i %>"><%= i %></a>
      <% } %> <% } %> <% if (currentPage < totalPages) { %>
      <a href="?page=<%= currentPage + 1 %>">Next &raquo;</a>
      <% } %>
    </div>
</section>
<%- include("../../views/partials/admin/footer") %>


<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script>
  document.getElementById("addBrandForm").addEventListener("submit", async function (e) {
    e.preventDefault();

    const form = e.target;
    const formData = new FormData(form);

    try {
      const response = await fetch("/admin/addBrand", {
        method: "POST",
        body: formData
      });

      const data = await response.json();

      if (!response.ok) throw new Error(data.error);

      Swal.fire({
        icon: "success",
        title: "Brand Added!",
        text: data.message || "Brand added successfully!",
      }).then(() => {
        location.reload(); // refresh to see the new brand in the table
      });

    } catch (err) {
      Swal.fire({
        icon: "error",
        title: "Error",
        text: err.message || "Something went wrong",
      });
    }
  });
</script>


