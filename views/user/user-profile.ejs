<%- include("../partials/user/header") %>
<link rel="stylesheet" href="/css/dashboard.css">

<style>
  body {
    background-color: #1a1a1a;
    color: #ffffff;
    font-family: 'Roboto', sans-serif;
  }

  .address-btn {
    margin-top: 10px;
    background: linear-gradient(90deg, #d4a017, #b8860b); 
    border: none;
    color: #fff;
    padding: 8px 15px;
    border-radius: 8px;
    transition: transform 0.3s ease, background 0.3s ease;
  }

  .address-btn:hover {
    transform: translateY(-2px);
    background: linear-gradient(90deg, #c79f15, #a67b0a);
    box-shadow: 0 4px 12px rgba(212, 160, 23, 0.5);
  }

  .profile-section {
    display: flex;
    flex-wrap: wrap;
    gap: 20px;
    margin-bottom: 30px;
    transition: opacity 0.3s ease;
    justify-content: flex-end; 
    margin-top: 20px;
  }

  .profile-section:hover {
    opacity: 0.95;
  }

  .profile-card {
    flex: 1;
    min-width: 200px;
    background: #2b2b2b;
    border-radius: 12px;
    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
    padding: 20px;
    text-align: center;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    position: relative;
    overflow: hidden;
  }

  .profile-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 3px;
    background: linear-gradient(90deg, #d4a017, #b8860b);
    transition: left 0.3s ease;
  }

  .profile-card:hover::before {
    left: 0;
  }

  .profile-card:hover {
    transform: translateY(-8px);
    box-shadow: 0 10px 25px rgba(212, 160, 23, 0.3);
  }

  .profile-card img {
    width: 80px;
    height: 80px;
    border-radius: 50%;
    object-fit: cover;
    margin-bottom: 10px;
    transition: transform 0.3s ease;
  }

  .profile-card:hover img {
    transform: scale(1.1);
  }

  .profile-card h6 {
    margin: 0 0 5px;
    color: #d4a017;
    font-weight: 600;
    transition: color 0.3s ease;
  }

  .profile-card:hover h6 {
    color: #c79f15;
  }

  .profile-card p {
    margin: 0;
    color: #aaaaaa;
    font-size: 14px;
    transition: color 0.3s ease;
  }

  .profile-card:hover p {
    color: #cccccc;
  }

  .profile-card .btn {
    margin-top: 10px;
    background: linear-gradient(90deg, #d4a017, #b8860b); 
    border: none;
    color: #fff;
    padding: 8px 15px;
    border-radius: 8px;
    transition: transform 0.3s ease, background 0.3s ease;
  }

  .profile-card .btn:hover {
    transform: translateY(-2px);
    background: linear-gradient(90deg, #c79f15, #a67b0a);
    box-shadow: 0 4px 12px rgba(212, 160, 23, 0.5);
  }

  .address-card {
    flex: 2;
    min-width: 300px;
  }

  .address-card address {
    font-style: normal;
    color: #aaaaaa;
    margin-bottom: 10px;
    transition: color 0.3s ease;
  }

  .address-card:hover address {
    color: #cccccc;
  }

  .recent-orders {
    margin-bottom: 30px;
    transition: opacity 0.3s ease;
  }

  .recent-orders:hover {
    opacity: 0.95;
  }

  .recent-orders .card {
    background: #2b2b2b;
    border-radius: 12px;
    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
    padding: 15px;
    display: inline-block;
    margin-right: 15px;
    width: 250px;
    vertical-align: top;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    position: relative;
    overflow: hidden;
  }

  .recent-orders .card::after {
    content: '';
    position: absolute;
    bottom: 0;
    right: -100%;
    width: 100%;
    height: 3px;
    background: linear-gradient(90deg, #d4a017, #b8860b);
    transition: right 0.3s ease;
  }

  .recent-orders .card:hover::after {
    right: 0;
  }

  .recent-orders .card:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 25px rgba(212, 160, 23, 0.3);
  }

  .recent-orders .card-header {
    background: none;
    color: #d4a017;
    font-size: 16px;
    font-weight: 600;
    padding: 0;
    margin-bottom: 10px;
    transition: color 0.3s ease;
  }

  .recent-orders .card:hover .card-header {
    color: #c79f15;
  }

  .recent-orders .status {
    display: inline-block;
    padding: 2px 8px;
    border-radius: 12px;
    font-size: 12px;
    margin-left: 5px;
    transition: transform 0.3s ease;
  }

  .recent-orders .card:hover .status {
    transform: scale(1.1);
  }

  .recent-orders .status.delivered { background: #48bb78; color: #fff; }
  .recent-orders .status.shipped { background: #63b3ed; color: #fff; }
  .recent-orders .status.processing { background: #ecc94b; color: #fff; }

  .recent-orders .price {
    font-size: 18px;
    font-weight: 600;
    color: #d4a017;
    margin: 10px 0;
    transition: color 0.3s ease;
  }

  .recent-orders .card:hover .price {
    color: #c79f15;
  }

  .recent-orders .items {
    color: #aaaaaa;
    font-size: 14px;
    margin-bottom: 10px;
    transition: color 0.3s ease;
  }

  .recent-orders .card:hover .items {
    color: #cccccc;
  }

  .recent-orders .btn {
    display: inline-block;
    margin-right: 5px;
    padding: 5px 10px;
    font-size: 14px;
    background: linear-gradient(90deg, #d4a017, #b8860b);
    border: none;
    color: #fff;
    border-radius: 6px;
    transition: transform 0.3s ease, background 0.3s ease;
  }

  .recent-orders .btn:hover {
    transform: translateY(-2px);
    background: linear-gradient(90deg, #c79f15, #a67b0a);
    box-shadow: 0 4px 12px rgba(212, 160, 23, 0.5);
  }

  .recent-orders .btn-cancel {
    background: #e53e3e;
    color: #fff;
    border: none;
    transition: transform 0.3s ease, background 0.3s ease;
  }

  .recent-orders .btn-cancel:hover {
    transform: translateY(-2px);
    background: #c53030;
  }

  @media (max-width: 768px) {
    .profile-section {
      flex-direction: column;
    }
    .recent-orders .card {
      width: 100%;
      margin-right: 0;
      margin-bottom: 15px;
    }
  }

  .row h4 {
    margin-top: 60px;
    color: #d4a017;
    font-weight: 700;
  }

  .text-muted {
    color: #aaaaaa !important;
  }
</style>

<main class="main">
  <div class="page-header breadcrumb-wrap mb-3">
    <div class="container">
      <div class="breadcrumb">
        <a href="#" rel="nofollow">Home</a>
        <span></span> Profile
      </div>
    </div>
  </div>
  <section class="pt-10 pb-10">
    <div class="container">
      <div class="row">
        <div class="col-lg-10 m-auto">
          <h4 class="mb-3 mt-40px">My Profile</h4>
          <p class="text-muted mb-4">Manage your account and view your orders</p>

          <div class="profile-section">
            <a href="/user-address" class="address-btn address-btn-primary">Manage Address</a>
          </div>

          <div class="profile-section">
            <div class="profile-card">
              <img src="<%= user.profileImage %>" alt="Profile Image" width="100">
              <h6><%= user.name %></h6>
              <p><%= user.email %></p>
              <p>Member since <%= new Date(user.createdAt).getFullYear() %></p>
              <a href="/edit-profile" class="btn btn-primary">Edit Profile</a>
            </div>
            <div class="profile-card">
              <i class="fi-rs-shopping-bag" style="font-size: 40px; color: #d4a017;"></i>
              <h6><%= orders.length %></h6>
              <p>Total Orders</p>
            </div>
            <div class="profile-card">
              <i class="fi-rs-dollar" style="font-size: 40px; color: #d4a017;"></i>
              <h6>$<%= orders.reduce((sum, order) => sum + order.total, 0).toFixed(2) %></h6>
              <p>Total Spent</p>
            </div>
            <div class="profile-card">
              <i class="fi-rs-star" style="font-size: 40px; color: #d4a017;"></i>
              <h6>Gold</h6>
              <p>Member Status</p>
            </div>
            <div class="profile-card address-card">
              <i class="fi-rs-marker" style="font-size: 40px; color: #d4a017;"></i>
              <h6>Shipping Address</h6>
              <% if (user.addresses.length > 0) { %>
                <address>
                  <%= user.addresses[0].street %>,<br>
                  <%= user.addresses[0].city %>, <%= user.addresses[0].state %>,<br>
                  <%= user.addresses[0].zip %>, <%= user.addresses[0].country %>
                </address>
                <span class="text-success">Verified (Default)</span>
              <% } else { %>
                <address>No address set</address>
              <% } %>
            </div>
          </div>

          <div class="recent-orders">
            <div class="card-header d-flex justify-content-between align-items-center">
              <h5>Recent Orders <span class="status" style="background: #ed8936; color: #fff;"> </span></h5>
              <a href="#orders" class="text-muted">View All Orders →</a>
            </div>
            <div class="card-body">
              <div class="card">
                <h6>#ORD-001 <span class="status delivered">Delivered</span></h6>
                <p>Month DD, YYYY</p>
                <p class="price">$0.00</p>
                <p class="items">0 items</p>
                <a href="#" class="btn btn-primary">View Details</a>
              </div>
              <div class="card">
                <h6>#ORD-002 <span class="status shipped">Shipped</span></h6>
                <p>Month DD, YYYY</p>
                <p class="price">$0.00</p>
                <p class="items">0 items</p>
                <a href="#" class="btn btn-primary">Track Order</a>
              </div>
              <div class="card">
                <h6>#ORD-003 <span class="status processing">Processing</span></h6>
                <p>Month DD, YYYY</p>
                <p class="price">$0.00</p>
                <p class="items">0 items</p>
                <a href="#" class="btn btn-primary">View Details</a>
                <button class="btn btn-cancel">Cancel</button>
              </div>
            </div>
          </div>

         
          <div class="tab-pane fade" id="orders" role="tabpanel" aria-labelledby="orders-tab">
            <div class="card">
              <div class="card-header">
                <h5 class="mb-0">Your Orders</h5>
              </div>
              <div class="card-body">
                <div class="table-responsive">
                  <table class="table">
                    <thead>
                      <tr>
                        <th>Order</th>
                        <th>Status</th>
                        <th>Total</th>
                        <th>Actions</th>
                      </tr>
                    </thead>
                    <tbody>
                      <% orders.forEach(order => { %>
                        <tr>
                          <td>#<%= order.orderId %></td>
                          <td><%= order.status %></td>
                          <td>₹<%= order.total %></td>
                          <td>
                            <% if (order.status !== 'Cancelled') { %>
                              <form action="/user/cancel-order/<%= order._id %>" method="POST">
                                <button type="submit" class="btn-small">Cancel</button>
                              </form>
                            <% } else { %>
                              <span>Cancelled</span>
                            <% } %>
                          </td>
                        </tr>
                      <% }) %>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
</main>
<%- include("../partials/user/footer") %>